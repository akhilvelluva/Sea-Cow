<b>The pipeline include following Steps</b>

1.Mapping of sea cow individual reads to Dugong genome
2.Bam Filter and statistics 
3.Genotyping of Sea cow reads 
4.PSMC
5.Genome Annotation
6.Orthologous Assessment
7.Codon based Alignment
8.Codeml run

#Mapping of sea cow individual reads to Dugong genome
Here we used the  fastq2bam for reading and  merging the fastq reads into BAM format. 
-m option will attempt to merge or trim reads. 
Bwa bam2bam will take the indexed reference genome file and map with the parameter set of -n (num-diff) -o (max-gap-open) -l (seed-length) -p (listen-port) -t (num-threads).

fastq2bam -m -1 Read_R1.fastq  -2 Read_R2.fastq |  bwa bam2bam -g Reference.fasta -n 0.01 -o 2 -l 16000 -p 4711 -t 48 -f Aligned.bam -

#Bam Filter and statistics
For removing duplicated and filtering based on the DNA fragment lengths and mapping quality we have used an in house perl program called analyzeBAM.pl with -minlength as 32 and -qual as 30.

#Genotyping of Sea cow reads
The genotyping of Sea cow individuals is done with snpAD tool and uses only the scaffold length  ≥ 100. The script name snpAD.sh used for genotyping with an input of scaffold names.

#PSMC
PSMC analysis requires a consensus genome sequence(fastq) that can be filtered to account for coverage and sequencing error. Only autosomal scaffolds longer than 100 kb can be used for the analysis.

1. Fastq sequence for autosomal regions
   Samtools mpileup -C50 -uf Reference.fasta Input.bam|bcftools call -c -|vcfutils.pl vcf2fq -d 10 -D 100 | gzip > diploid.fq.gz
2. Fastq to PSMC
   fq2psmcfa -q20  diploid.fq.gz > Input.psmcfa
3. Run PSMC
   psmc  -t40 -p "4+25*2+4+6" -o Input.psmc  Input.psmcfa
4. Combine out (If you have more than one Individuals) 
   cat Input.psmc Input02.psmc >combined.psmc 
5. Plot
   psmc_plot.pl -u “Mutation Rate” -g “Generation Time”  combined combined.psmc
6. Perform bootstrapping (100 rounds)
   splitfa Input.psmcfa >split-Input.psmcfa
   seq 100 |xargs -i echo psmc -t40 -b -p "4+25*2+4+6" -o Input{}.psmc split-Input.psmcfa | sh

#Genome Annotation

For performing  the annotation EST or Protein Homology evidence is needed. For this we used Elephant, Human and Mouse assembled mRNA and protein sequence. 

1. First Round
The maker runs with the control files (ctl) such as maker_bopts, maker_exe and maker_opts.
In maker_opts.ctl you need add the location/Informations on the following fields
Genome,organism_type,est and protein.Also set the following flags to enable gene prediction solely on RNA and protein evidence:
est2genome=1 #infer gene predictions directly from ESTs, 1 = yes, 0 = no 
protein2genome=1 #infer predictions from protein homology, 1 = yes, 0 = no 
After execution of  MAKER results are stored in a directory with the name of your assembly file plus .maker.output
Two accessory scripts that come with MAKER : gff3_merge and fasta_merge used for merge GFF3 and FASTA files containing all genes.
fasta_merge -d xxx_datastore_index.log
gff3_merge -d xxx_datastore_index.log

1.a: Train the gene gene predictor(SNAP)
The maker2zff will create two files such as genome.ann and genome.dna which contain information about the gene sequences as well as the actual DNA sequences. 
maker2zff  xxx_all.gff
Then run fathom as follows 
fathom genome.ann genome.dna -categorize 1000 
fathom uni.ann uni.dna -export 1000 
forge export.ann export.dna
Finally train SNAP with hmm-assemble
hmm-assembler .pl mygenome . >mygenome.hmm
2. Run Second Round
Add snaphmm= mygenome.hmm,remove the file paths to the genome,protein and est evidence or set the flags for est2genome=0 and protein2genome=0 and add xxx_all.gff (First round gff) to maker_gff, set all option under Re-annotation Using MAKER Derived GFF3 as one.


#Orthologous Assessment
#Codon based Alignment
#Codeml run
